<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TCODM | Official Tournament League</title>
    
    <link rel="icon" type="image/png" href="iconoweb.png">
    
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-database.js"></script>

    <style>
        :root {
            --y: #F4CB33; 
            --bg: #050505;
            --nav-bg: rgba(15, 15, 15, 0.98);
            --gray: #888;
        }

        body {
            background-color: var(--bg);
            color: white;
            margin: 0;
            font-family: "Arial", sans-serif;
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        nav {
            width: 100%;
            background-color: var(--nav-bg);
            padding: 12px 0;
            display: flex;
            justify-content: space-around;
            align-items: center;
            border-bottom: 2px solid var(--y);
            position: fixed;
            top: 0;
            z-index: 1000;
            backdrop-filter: blur(10px);
        }

        .logo { font-size: 22px; font-weight: 900; letter-spacing: 2px; }
        .logo .t-gray { color: var(--gray); }
        .logo .codm-yellow { color: var(--y); }

        .hero-banner {
            margin-top: 55px;
            width: 100%;
            max-width: 1200px;
            height: 45vh; 
            background: url('gif1.gif') no-repeat center center;
            background-size: contain;
            background-color: #000;
        }

        .content {
            width: 90%;
            max-width: 850px;
            padding: 40px 0;
        }

        .description-box {
            text-align: left;
            background: #0d0d0d;
            padding: 25px;
            border-left: 4px solid var(--y);
            margin-bottom: 30px;
            line-height: 1.7;
        }

        /* --- TABLA DE PUNTOS --- */
        .puntos-table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
            background: #111;
            font-size: 14px;
        }
        .puntos-table th { background: var(--y); color: black; padding: 10px; }
        .puntos-table td { padding: 10px; border: 1px solid #222; text-align: center; }

        #pago-requerido {
            background: #1a0f00;
            border: 1px solid #3d2b00;
            padding: 30px;
            border-radius: 4px;
            margin: 20px 0;
            text-align: center;
        }

        .registro-box {
            background: #111;
            padding: 35px;
            border: 1px solid #222;
            display: none;
        }

        input {
            width: 100%;
            padding: 14px;
            margin-bottom: 12px;
            background: #000;
            border: 1px solid #444;
            color: white;
            box-sizing: border-box;
        }

        .btn-final {
            width: 100%;
            padding: 18px;
            background: var(--y);
            color: black;
            font-weight: 900;
            border: none;
            cursor: pointer;
            text-transform: uppercase;
        }

        /* --- LISTA DE INSCRITOS --- */
        .inscritos-section {
            margin-top: 50px;
            width: 100%;
            background: #0a0a0a;
            padding: 20px;
            border-radius: 8px;
        }
        .inscritos-table { width: 100%; border-collapse: collapse; }
        .inscritos-table th { color: var(--y); text-align: left; padding: 10px; border-bottom: 2px solid #222; }
        .inscritos-table td { padding: 10px; border-bottom: 1px solid #111; font-size: 14px; color: #ccc; }

        footer { padding: 40px; text-align: center; color: #333; font-size: 11px; }
    </style>
</head>
<body>

    <nav>
        <div class="logo"><span class="t-gray">T</span><span class="codm-yellow">CODM</span></div>
        <a href="https://buy.stripe.com/4gM8wHey05kI44CfbN4ow00" style="text-decoration:none; background:var(--y); color:black; padding:8px 15px; font-weight:bold; font-size:12px;">PAGAR SLOT</a>
    </nav>

    <section class="hero-banner"></section>

    <main class="content">
        <h2 style="text-align:center; letter-spacing:2px;">SISTEMA DE COMPETENCIA</h2>
        
        <div class="description-box">
            <h3 style="color:var(--y); margin-top:0;">RECOMPENSAS Y REGLAS</h3>
            <p>Torneo exclusivo para <strong>25 Squads (100 jugadores)</strong>. El pozo acumulado es de <strong>$125 USD</strong>, distribuido tras descontar el 20% de gesti√≥n administrativa.</p>
            
            <table class="puntos-table">
                <thead>
                    <tr><th>POSICI√ìN</th><th>PREMIO</th><th>PUNTOS</th></tr>
                </thead>
                <tbody>
                    <tr><td>ü•á 1er Lugar</td><td>$60.00 USD</td><td>25 pts</td></tr>
                    <tr><td>ü•à 2do Lugar</td><td>$25.00 USD</td><td>18 pts</td></tr>
                    <tr><td>ü•â 3er Lugar</td><td>$15.00 USD</td><td>12 pts</td></tr>
                </tbody>
            </table>
            <p style="text-align: center; background: #222; padding: 10px; border-radius: 4px;">
                üî• <strong>BONO POR KILL:</strong> Cada baja confirmada suma <strong>+1 Punto</strong> a la tabla general.
            </p>
        </div>

        <div id="pago-requerido">
            <h3 style="color: var(--y); margin-top:0;">1. PAGA TU INSCRIPCI√ìN ($5.00)</h3>
            <p>Una vez completado el pago en Stripe, ser√°s redirigido para anotar los nombres de tus jugadores.</p>
            <a href="https://buy.stripe.com/4gM8wHey05kI44CfbN4ow00" class="btn-final" style="text-decoration:none; display:inline-block; width:auto; padding: 15px 40px;">IR A PAGAR</a>
        </div>

        <div id="registro-box" class="registro-box">
            <h3 style="color: #4CAF50; text-align:center; margin-top:0;">‚úì PAGO VERIFICADO</h3>
            <input type="text" id="teamName" placeholder="Nombre de la Squad">
            <input type="text" id="capitan" placeholder="ID Capit√°n (IGL)">
            <input type="text" id="p2" placeholder="ID Jugador 2">
            <input type="text" id="p3" placeholder="ID Jugador 3">
            <input type="text" id="p4" placeholder="ID Jugador 4">
            <button class="btn-final" onclick="enviarFirebase()">REGISTRAR EQUIPO</button>
        </div>

        <div class="inscritos-section">
            <h3 style="color: var(--y); margin-top:0;">EQUIPOS CONFIRMADOS (CUPOS: 25)</h3>
            <table class="inscritos-table">
                <thead>
                    <tr>
                        <th>SQUAD</th>
                        <th>CAPIT√ÅN</th>
                        <th>ESTADO</th>
                    </tr>
                </thead>
                <tbody id="lista-equipos">
                    </tbody>
            </table>
        </div>

    </main>

    <footer>
        ¬© <span id="year"></span> TCODM LEAGUE | POWERED BY STRIPE & FIREBASE
    </footer>

    <script>
        document.getElementById('year').innerText = new Date().getFullYear();

        // CONFIGURACI√ìN FIREBASE
        const firebaseConfig = { databaseURL: "https://tcodm-e4147-default-rtdb.firebaseio.com/" };
        firebase.initializeApp(firebaseConfig);
        const database = firebase.database();

        // DETECTAR PAGO
        window.onload = function() {
            const params = new URLSearchParams(window.location.search);
            if (params.get('status') === 'success') {
                document.getElementById('pago-requerido').style.display = 'none';
                document.getElementById('registro-box').style.display = 'block';
            }
            cargarEquipos();
        };

        // GUARDAR EN FIREBASE
        function enviarFirebase() {
            const team = document.getElementById('teamName').value;
            const cap = document.getElementById('capitan').value;

            if(!team || !cap) return alert("Llena los campos obligatorios");

            database.ref('inscripciones/' + team).set({
                capitan: cap,
                jugadores: [document.getElementById('p2').value, document.getElementById('p3').value, document.getElementById('p4').value],
                pago: "CONFIRMADO",
                fecha: new Date().toLocaleString()
            }).then(() => {
                alert("¬°Inscripci√≥n completada!");
                window.location.href = "index.html";
            });
        }

        // CARGAR LISTA EN TIEMPO REAL
        function cargarEquipos() {
            const tableBody = document.getElementById('lista-equipos');
            database.ref('inscripciones').on('value', (snapshot) => {
                tableBody.innerHTML = "";
                snapshot.forEach((childSnapshot) => {
                    const data = childSnapshot.val();
                    const row = `<tr>
                        <td>${childSnapshot.key}</td>
                        <td>${data.capitan}</td>
                        <td style="color:#4CAF50;">‚óè Verificado</td>
                    </tr>`;
                    tableBody.innerHTML += row;
                });
            });
        }
    </script>
</body>
</html>
