<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TCODM | Official Tournament League</title>
    
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-database.js"></script>

    <style>
        :root {
            --y: #F4CB33; /* Amarillo intenso CODM */
            --bg: #050505;
            --nav-bg: rgba(15, 15, 15, 0.98);
            --gray: #888;
        }

        body {
            background-color: var(--bg);
            color: white;
            margin: 0;
            font-family: "Arial", sans-serif;
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        /* --- NAVEGACIÓN --- */
        nav {
            width: 100%;
            background-color: var(--nav-bg);
            padding: 12px 0;
            display: flex;
            justify-content: space-around;
            align-items: center;
            border-bottom: 2px solid var(--y);
            position: fixed;
            top: 0;
            z-index: 1000;
            backdrop-filter: blur(10px);
        }

        .logo { font-size: 22px; font-weight: 900; letter-spacing: 2px; }
        .logo .t-gray { color: var(--gray); }
        .logo .codm-yellow { color: var(--y); }

        .btn-nav-pay {
            background: var(--y);
            color: black;
            border: none;
            padding: 8px 18px;
            font-weight: bold;
            text-transform: uppercase;
            cursor: pointer;
            text-decoration: none;
            font-size: 13px;
        }

        /* --- BANNER PRINCIPAL (GIF) --- */
        .hero-banner {
            margin-top: 55px;
            width: 100%;
            max-width: 1200px;
            height: 45vh; 
            background: url('gif1.gif') no-repeat center center;
            background-size: contain;
            background-color: #000;
        }

        /* --- CONTENIDO --- */
        .content {
            width: 90%;
            max-width: 850px;
            padding: 40px 0;
            text-align: center;
        }

        .description-box {
            text-align: left;
            background: #0d0d0d;
            padding: 25px;
            border-left: 4px solid var(--y);
            margin-bottom: 30px;
            line-height: 1.7;
        }

        /* --- BOTONES CP STORE --- */
        .cp-container {
            display: flex;
            justify-content: center;
            gap: 15px;
            margin: 25px 0;
            flex-wrap: wrap;
        }

        .btn-cp {
            background: #1a1a1a;
            border: 1px solid #333;
            color: white;
            padding: 12px 20px;
            font-weight: bold;
            border-radius: 4px;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        .cp-icon { width: 18px; height: 18px; background: var(--y); border-radius: 50%; }

        /* --- BLOQUE DE PAGO (PASO 1) --- */
        #pago-requerido {
            background: #1a0f00;
            border: 1px solid #3d2b00;
            padding: 30px;
            border-radius: 4px;
            margin: 20px 0;
        }

        /* --- FORMULARIO (BLOQUEADO POR DEFECTO) --- */
        .registro-box {
            background: #111;
            padding: 35px;
            border: 1px solid #222;
            text-align: left;
            display: none; /* Se activa con JS */
        }

        input {
            width: 100%;
            padding: 14px;
            margin-bottom: 15px;
            background: #000;
            border: 1px solid #444;
            color: white;
            box-sizing: border-box;
            outline: none;
        }
        input:focus { border-color: var(--y); }

        .btn-final {
            width: 100%;
            padding: 18px;
            background: var(--y);
            color: black;
            font-weight: 900;
            border: none;
            cursor: pointer;
            text-transform: uppercase;
            font-size: 16px;
        }

        .legal {
            font-size: 11px;
            color: #555;
            margin-top: 50px;
            text-align: left;
            border-top: 1px solid #222;
            padding-top: 20px;
        }

        footer { padding: 40px; text-align: center; color: #333; font-size: 12px; }
    </style>
</head>
<body>

    <nav>
        <div class="logo"><span class="t-gray">T</span><span class="codm-yellow">CODM</span></div>
        <a href="https://buy.stripe.com/4gM8wHey05kI44CfbN4ow00" class="btn-nav-pay">PAGAR SLOT</a>
    </nav>

    <section class="hero-banner"></section>

    <main class="content">
        <h2>TORNEO DE TEMPORADA</h2>
        
        <div class="description-box">
            <strong>Acerca de TCODM League:</strong><br>
            Esta plataforma es el centro de operaciones oficial para la gestión de torneos competitivos de Battle Royale en CODM. Nuestra misión es profesionalizar la escena competitiva, asegurando que cada inscripción contribuya directamente al pozo de premios (Prize Pool). Utilizamos <strong>Stripe</strong> para transacciones seguras y <strong>Firebase</strong> para el registro de datos en tiempo real.
        </div>

        <div class="cp-container">
            <div class="btn-cp"><span class="cp-icon"></span> 80 CP</div>
            <div class="btn-cp"><span class="cp-icon"></span> 420 CP</div>
            <div class="btn-cp"><span class="cp-icon"></span> 880 CP</div>
        </div>

        <div id="pago-requerido">
            <h3 style="color: var(--y); margin-top:0;">PAGO REQUERIDO</h3>
            <p>Para desbloquear el registro de tu Squad en la base de datos, primero debes completar el pago de inscripción.</p>
            <a href="https://buy.stripe.com/4gM8wHey05kI44CfbN4ow00" class="btn-final" style="display:inline-block; text-decoration:none; width:auto; padding: 15px 40px;">PAGAR AHORA ($0.50)</a>
        </div>

        <div id="registro-box" class="registro-box">
            <h3 style="color: #4CAF50; text-align:center; margin-top:0;">✓ PAGO CONFIRMADO</h3>
            <p style="text-align: center; color: #aaa;">Completa los datos oficiales de tu equipo para Firebase.</p>
            
            <input type="text" id="teamName" placeholder="Nombre de la Squad">
            <input type="text" id="capitan" placeholder="ID del Capitán (IGL)">
            <input type="text" id="p2" placeholder="Jugador 2">
            <input type="text" id="p3" placeholder="Jugador 3">
            <input type="text" id="p4" placeholder="Jugador 4">
            
            <button class="btn-final" onclick="enviarFirebase()">FINALIZAR INSCRIPCIÓN</button>
        </div>

        <div class="legal">
            <p><strong>POLÍTICA DE REEMBOLSO:</strong> Debido a la naturaleza competitiva, las inscripciones no son reembolsables una vez que el equipo ha sido registrado en la base de datos.</p>
            <p><strong>DERECHOS:</strong> Call of Duty® es una marca registrada de Activision Publishing, Inc. TCODM League es un organizador independiente.</p>
        </div>
    </main>

    <footer>
        © <span id="year"></span> TCODM LEAGUE | POWERED BY STRIPE & FIREBASE
    </footer>

    <script>
        document.getElementById('year').innerText = new Date().getFullYear();

        // --- 1. DETECTAR PAGO EXITOSO ---
        window.onload = function() {
            const params = new URLSearchParams(window.location.search);
            if (params.get('status') === 'success') {
                document.getElementById('pago-requerido').style.display = 'none';
                document.getElementById('registro-box').style.display = 'block';
            }
        };

        // --- 2. CONFIGURACIÓN FIREBASE ---
        const firebaseConfig = {
            databaseURL: "https://tcodm-e4147-default-rtdb.firebaseio.com/"
        };
        firebase.initializeApp(firebaseConfig);
        const database = firebase.database();

        function enviarFirebase() {
            const team = document.getElementById('teamName').value;
            const cap = document.getElementById('capitan').value;

            if(team === "" || cap === "") {
                alert("Por favor completa los campos obligatorios.");
                return;
            }

            database.ref('inscripciones/' + team).set({
                capitan: cap,
                equipo: [
                    document.getElementById('p2').value,
                    document.getElementById('p3').value,
                    document.getElementById('p4').value
                ],
                pago_status: "VERIFICADO",
                fecha: new Date().toLocaleString()
            }).then(() => {
                alert("¡EQUIPO REGISTRADO EXITOSAMENTE!");
                window.location.href = "index.html"; // Limpiar la URL
            }).catch(e => alert("Error: " + e.message));
        }
    </script>
</body>
</html>
